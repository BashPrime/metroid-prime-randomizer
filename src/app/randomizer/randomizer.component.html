<section class="section">
  <div class="container">
    <h2 class="title is-size-3">Generate Randomized Game</h2>
    <div class="columns">
      <div class="column is-3">
        <aside class="menu box">
          <form #randomizerForm="ngForm" (ngSubmit)="onSubmit()">
            <p class="menu-label">Seed Number</p>
            <div class="field">
              <div class="control">
                <input class="input" type="number" min="1" max="999999999" name="seed" placeholder="Random Seed" [(ngModel)]="selectedSeed"
                  #seed="ngModel" />
              </div>
            </div>
            <p class="menu-label">Logic</p>
            <div class="field">
              <div class="control">
                <div class="select">
                  <select [(ngModel)]="selectedLogic" name="logic">
                    <option *ngFor="let logic of logics" [value]="logic.value">
                      {{ logic.name }}
                    </option>
                  </select>
                </div>
                <p class="has-text-danger" *ngIf="selectedLogic !== defaultLogic">
                  This logic requires knowledge of glitches and more advanced movement.
                </p>
              </div>
            </div>
            <p class="menu-label">Mode</p>
            <div class="field">
              <div class="control">
                <div class="select">
                  <select [(ngModel)]="selectedMode" name="mode">
                    <option *ngFor="let mode of modes" [value]="mode.value">
                      {{ mode.name }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <p class="menu-label">Artifacts</p>
            <div class="field">
              <div class="control">
                <div class="select">
                  <select [(ngModel)]="selectedArtifacts" name="artifacts">
                    <option *ngFor="let artifact of artifacts" [value]="artifact.value">
                      {{ artifact.name }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <p class="menu-label">Difficulty</p>
            <div class="field">
              <div class="control">
                <div class="select">
                  <select [(ngModel)]="selectedDifficulty" name="difficulty">
                    <option *ngFor="let difficulty of difficulties" [value]="difficulty.value">
                      {{ difficulty.name }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <hr>
            <button class="button is-primary is-large is-fullwidth" type="submit">Randomize</button>
          </form>
        </aside>
        <p class="has-text-weight-bold has-text-centered">
          <a target="_blank" routerLink="/help/patching-instructions">Patching Instructions</a>
        </p>
      </div>
      <div class="column">
        <p class="subtitle is-size-3 has-text-centered" *ngIf="!regions">Click the Randomize button to generate a game!</p>
        <div class="hero is-small is-primary" style="margin-bottom: 2em;" *ngIf="regions">
          <div class="hero-body">
            <h3 class="title">Game Details</h3>
          </div>
        </div>
        <div *ngIf="regions">
          <table class="table is-striped is-fullwidth">
            <tbody>
              <tr>
                <th>Mode</th>
                <td>{{ randomizer.getMode() }}</td>
              </tr>
              <tr>
                <th>Logic</th>
                <td>{{ randomizer.getLogic() }}</td>
              </tr>
              <tr>
                <th>Artifacts</th>
                <td>{{ randomizer.getRandomizedArtifacts() }}</td>
              </tr>
              <tr>
                <th>Difficulty</th>
                <td>{{ randomizer.getDifficulty() }}</td>
              </tr>
              <tr>
                <th>Seed</th>
                <td>{{ randomizer.getSeed() }}</td>
              </tr>
              <tr>
                <th>Version</th>
                <td>{{ version }}</td>
              </tr>
            </tbody>
          </table>
          <div class="field">
            <label class="label">Layout Descriptor</label>
            <div class="control is-expanded">
              <div class="field has-addons">
                <div class="control is-expanded">
                  <input class="input" type="text" [value]="layoutDescriptor" readonly />
                </div>
                <div class="control">
                  <button class="button is-primary" ngxClipboard [cbContent]="layoutDescriptor" (cbOnSuccess)="openSnackBar('Copied to clipboard.', 'Close')">Copy</button>
                </div>
              </div>
            </div>
          </div>
          <div class="field">
            <label class="label">Spoilers</label>
            <div class="control">
              <div class="field is-grouped">
                <div class="control">
                  <button class="button is-light" (click)="toggleSpoilers = !toggleSpoilers">{{ !toggleSpoilers ? "Show" : "Hide" }} Spoilers</button>
                </div>
                <div class="control">
                  <a class="button is-primary" title="Download Spoiler Log" [href]="downloadJsonHref" download="{{spoilerFileName}}">Download Spoiler Log</a>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="toggleSpoilers">
            <hr>
            <div class="field is-grouped">
              <div class="control">
                <div class="select">
                  <select [(ngModel)]="selectedRegionIndex">
                    <option *ngFor="let region of regions; let i = index" [value]="i">
                      {{ region.getName() }}
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <div *ngFor="let region of regions; let i = index">
              <table class="table is-striped is-fullwidth" *ngIf="selectedRegionIndex == i">
                <thead>
                  <tr>
                    <th title="Location">Location</th>
                    <th title="Item">Item</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let location of region.getLocationsArray()">
                    <td>{{ location.getName() }}</td>
                    <td>{{ location.getItem().getName() }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
