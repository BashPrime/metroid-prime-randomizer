<div [formGroup]="getFormGroup()">
  <p-dataView [value]="getFormArray().controls" formArrayName="itemOverrides">
    <p-header>
      <div class="select is-small" style="margin-right: 0.5rem;" *ngIf="getAvailableItems().length">
        <select [(ngModel)]="selectedAvailableItem" [ngModelOptions]="{standalone: true}">
          <option *ngFor="let item of getAvailableItems()" [ngValue]="item">{{ item.name }}</option>
        </select>
      </div>
      <button class="button is-success is-small" [disabled]="!getAvailableItems().length"
        (click)="addFormItem()">Add</button>
      <button class="button is-danger is-small is-pulled-right" [disabled]="!getFormArray().length"
        (click)="removeAllItems()">Remove All</button>
    </p-header>
    <ng-template let-override let-i="rowIndex" pTemplate="listItem">
      <div class="item-override" [formGroupName]="i">
        <div class="field">
          <!-- <label class="label is-small">Item Name</label> -->
          <div class="control">
            <p>{{ override.value.name }}</p>
          </div>
        </div>
        <div class="field">
          <label class="label is-small">State</label>
          <div class="control">
            <div class="select is-small">
              <select formControlName="state">
                <option *ngFor="let choice of getConditionalChoices(override.value.name)" [ngValue]="choice.value">
                  {{ choice.name }}
                </option>
              </select>
            </div>
          </div>
        </div>
        <div class="field" *ngIf="isCountEnabled(override.value)">
          <label class="label is-small">Count</label>
          <div class="control">
            <input class="input has-width-auto is-small" type="number" formControlName="count">
          </div>
        </div>
        <div class="field">
          <div class="control">
            <button class="button is-danger is-small" (click)="removeFormItem(i)">Remove</button>
          </div>
        </div>
      </div>
    </ng-template>
  </p-dataView>
</div>
